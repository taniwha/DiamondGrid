values {
	trunc = ${lambda x, n = 0: math.floor(x * 10**n) / 10**n}
	displacement = ${volumes['Displacement'][1]}
	skin = ${volumes['HabSkin'][0]}
	storage = ${volumes['Storage'][1]}
	habspace = ${volumes['HabSpace'][1]}
	structure = ${volumes['HabStructure'][1]}
	shell = ${displacement - (habspace + storage)}
	shield = ${shell}
	structure_mass = ${(7.8 * 0.075 + 0.95 * 0.925) * structure}
	shield_mass = ${7.8 * skin + 0.95 * (shell - skin)}
	mass = ${round(structure_mass + shield_mass, 3)}
	capacity = ${trunc(storage, 3)}
	resourceCapacity = ${trunc(capacity*200)}
	LiquidFuel = ${9 * resourceCapacity / 20}
	Oxidizer = ${11 * resourceCapacity / 20}
	resourceCost = ${LiquidFuel * 0.8 + Oxidizer * 0.18}
	//output = ${print(f"disp:{displacement} skin:{skin} storage:{storage} hab:{habspace} shell:{shell} structure:{structure}")}
	//output = ${print(f"shield:{shield} mass:{mass} capacity:{capacity} resourceCapacity:{resourceCapacity}")}
	//output = ${print(f"fun:{volumes['HabSkin'][1]} structure:{structure_mass} shield:{shield_mass}")}
}
PART
{
	name = DiamondGridHabCrew375
	module = Part
	author = Bill Currie

	MODEL {
		model = DiamondGrid/Parts/DGH-Crew-375
		position = 0, 0, 0
		rotation = 0, 0, 0
		scale = 1, 1, 1
	}
	rescaleFactor = 1.0
	scale = 1.0


	TechRequired = advConstruction
	entryCost = 8000
	cost = ${math.floor((mass * 600 * 1.2 + resourceCost) * 100 + 0.5) / 100}
	category = Structural
	subcategory = 0
	title = DGH-Crew-375
	manufacturer = Kairyuu Shipping
	description = Luxury crew can.

	// attachment rules: stack, srfAttach, allowStack, allowSrfAttach, allowCollision
	attachRules = 1,0,1,1,0
	bulkheadProfiles = dgsize2

	mass = ${mass}
	dragModelType = default
	maximum_drag = 0.2
	minimum_drag = 0.15
	angularDrag = 2
	crashTolerance = 8
	breakingForce = 200
	breakingTorque = 200
	maxTemp = 1700

	CrewCapacity = 6

	MODULE {
		name = ModuleScienceContainer
		reviewActionName = #autoLOC_502204 //#autoLOC_502204 = Review Data
		storeActionName = #autoLOC_502202 //#autoLOC_502202 = Store Experiments
		collectActionName = #autoLOC_238018 //#autoLOC_238018 = Take Data
		evaOnlyStorage = True
		storageRange = 2
		allowRepeatedSubjects = True
	}
	MODULE {
		name = ModuleScienceLab
		containerModuleIndex = 0
		dataStorage = 750
		crewsRequired = 1
		canResetConnectedModules = True
		canResetNearbyModules = True
		interactionRange = 5
		SurfaceBonus = 0.1
		ContextBonus = 0.25
		homeworldMultiplier = 0.1
		RESOURCE_PROCESS {
			name = ElectricCharge
			amount = 10
		}
	}
	MODULE {
		name = ModuleScienceConverter
		dataProcessingMultiplier = 0.5
		scientistBonus = 0.25
		researchTime = 7
		scienceMultiplier = 5
		scienceCap = 500
		powerRequirement = 5
		ConverterName = #autoLOC_502055 //#autoLOC_502055 = Research
		StartActionName = #autoLOC_502056 //#autoLOC_502056 = Start Research
		StopActionName = #autoLOC_502057 //#autoLOC_502057 = Stop Research
	}
	MODULE {
		name = ModuleKerbNetAccess
		MinimumFoV = 17
		MaximumFoV = 63
		AnomalyDetection = 0
		DISPLAY_MODES {
			Mode = Terrain,#autoLOC_438839 //#autoLOC_438839 = Terrain
			Mode = Biome,#autoLOC_438890 //#autoLOC_438890 = Biome
		}
		REQUIRED_EFFECTS {
			Effect = ScienceSkill
		}
	}
	MODULE {
		name = ModuleExperienceManagement
		costPerKerbal = 0
	}
	MODULE {
		name = ModuleColorChanger
		shaderProperty = _EmissiveColor
		animRate = 0.8
		animState = false
		useRate = true
		toggleInEditor = true
		toggleInFlight = true
		toggleInFlight = true
		unfocusedRange = 5
		toggleName = #autoLOC_502011 //#autoLOC_502011 = Toggle Lights
		eventOnName = #autoLOC_502012 //#autoLOC_502012 = Lights On
		eventOffName = #autoLOC_502013 //#autoLOC_502013 = Lights Off
		toggleAction = True
		defaultActionGroup = Light
		redCurve {
			key = 0 0 0 3
			key = 1 1 0 0
		}
		greenCurve {
			key = 0 0 0 1
			key = 1 1 1 0
		}
		blueCurve {
			key = 0 0 0 0
			key = 1 0.7 1.5 0
		}
		alphaCurve {
			key = 0 1
		}
	}

	RESOURCE {
		name = LiquidFuel
		amount = ${LiquidFuel}
		maxAmount = ${LiquidFuel}
	}
	RESOURCE {
		name = Oxidizer
		amount = ${Oxidizer}
		maxAmount = ${Oxidizer}
	}
}

@PART[DiamondGridHabCrew375]:NEEDS[ModularStorageContainer] {
	MODULE {
		name = ModuleStorageContainer
		availableVolume = ${capacity}
		Container {
			name = Resource
			volume = ${capacity}
			LiquidFuel = ${"%g, %g" % (LiquidFuel, LiquidFuel)}
			Oxidizer = ${"%g, %g" % (Oxidizer, Oxidizer)}
		}
	}
}

@PART[DiamondGridHabCrew375]:NEEDS[modularFuelTanks&!ModularStorageContainer] {
	MODULE {
		name = ModuleFuelTanks
		volume = ${resourceCapacity}
		type = Default
	}
}

@PART[DiamondGridHabCrew375]:NEEDS[ConnectedLivingSpace] {
	MODULE {
		name = ModuleConnectedLivingSpace
		passable = true
	}
}
